{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NavBar</title>
    {% include 'referencias.html' %}
</head>

<body data-bs-theme="dark">
    <nav class="navbar navbar-expand-lg bg-dark border-bottom border-body">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">PetCare</a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="{% url 'listar' %}">Ver página
                            principal</a>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'crear' %}">Servicios</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Citas</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Mascotas</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Dueños</a></li>
                </ul>

                <!-- derecha -->
                <div class="ms-auto d-flex align-items-center gap-3">
                    <!-- Toggle tema -->
                    <label for="theme-switch" class="toggle" title="Cambiar tema">
                        <input type="checkbox" class="input" id="theme-switch" />
                        <div class="icon icon--moon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" height="28"
                                fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </div>
                        <div class="icon icon--sun">
                            <!-- Sol icon -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="28" height="28"
                                fill="currentColor">
                                <path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75z
                                        M7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0z
                                        M18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.06 1.061l1.591-1.59z
                                        M21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75z
                                        M17.834 18.894a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 10-1.061 1.06l1.59 1.591z
                                        M12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18z
                                        M7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59z
                                        M6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12z
                                        M6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.59 1.591z">
                                </path>
                            </svg>
                        </div>
                    </label>

                    <!-- Logout -->
                    <form method="post" action="">
                        {% csrf_token %}
                        <button type="submit" class="Btn" aria-label="Cerrar sesión" title="Cerrar sesión">
                            <div class="sign">
                                <svg viewBox="0 0 512 512" aria-hidden="true" focusable="false">
                                    <path
                                        d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z" />
                                </svg>
                            </div>
                            <div class="text">Cerrar sesión</div>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </nav>
    <script>
        (function () {
            const STORAGE_KEY = "petcare-theme";
            const htmlEl = document.documentElement; // or document.body
            const switchEl = document.getElementById("theme-switch");

            // Inicial: preferencia guardada o media query
            const saved = localStorage.getItem(STORAGE_KEY);
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            const initialTheme = saved || (prefersDark ? "dark" : "light");

            setTheme(initialTheme);

            // Marcar el switch según tema actual
            switchEl.checked = (initialTheme === "light"); // porque el check muestra el sol
            updateNavbarClasses(initialTheme);

            switchEl.addEventListener("change", () => {
                const newTheme = switchEl.checked ? "light" : "dark";
                setTheme(newTheme);
                updateNavbarClasses(newTheme);
                localStorage.setItem(STORAGE_KEY, newTheme);
            });

            function setTheme(theme) {
                // Bootstrap 5.3 usa data-bs-theme
                document.body.setAttribute("data-bs-theme", theme);
            }

            function updateNavbarClasses(theme) {
                // Alterna clases para fondo/contraste del navbar
                const nav = document.querySelector("nav.navbar");
                if (!nav) return;
                nav.classList.remove("bg-dark", "navbar-dark", "bg-light", "navbar-light");
                if (theme === "dark") {
                    nav.classList.add("bg-dark", "navbar-dark");
                } else {
                    nav.classList.add("bg-light", "navbar-light");
                }
            }
        })();
    </script>
</body>

</html>